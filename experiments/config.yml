short_name: aptos
n_gpu: 1
save_dir: saved/
seed: 1234

arch:
  type: EffNet
  args:
    #depth: 28
    model: b2
    num_classes: 1
    #widen_factor: 10
    #in_channel: 3
    #dropout: 0.3
    pretrained: true
    verbose: 0

data_loader:
  type: NpyDataLoader
  args:
    batch_size: 32
    data_dir: data/preprocessed
    num_workers: 16
    validation_split: 0.0
    img_size: 256
    train: true
    alpha: 0.8
    verbose: 2

loss:
  type: RobustLoss
  args:
    reduction: mean

lr_scheduler:
  type: MultiStepLR
  args:
    milestones:
      - 20
      - 25
      - 30
    gamma: 0.2

metrics:
- quadratic_weighted_kappa
- conf_matrix
- accuracy

optimizer:
  type: Adam
  args:
    lr: 0.0003
    # momentum: 0.9
    # nesterov: True
    weight_decay: 0.0005

training:
  early_stop: 60
  epochs: 35
  # monitor: min val_loss
  save_period: 1
  tensorboard: true
  verbose: 2

testing:
  data_dir: data/raw
  ensemble_size: 5
  batch_size: 64
  img_size: 256
  num_workers: 16
  verbose: 2
