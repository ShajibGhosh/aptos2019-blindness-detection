short_name: aptos
n_gpu: 1
save_dir: saved/
seed: 1234

arch:
  type: ResNet18MaxAvg
  args:
    num_classes: 5
    in_channel: 3
    dropout: 0.3
    pretrained: false
    verbose: 2

data_loader:
  type: PngDataLoader
  args:
    batch_size: 64
    data_dir: data/raw
    num_workers: 16
    shuffle: true
    validation_split: 0.2
    verbose: 2

loss: ce_loss

lr_scheduler:
  type: MultiStepLR
  args:
    milestones:
      - 30
      - 60
      - 90
      - 120
      - 160
    gamma: 0.2

metrics:
- quadratic_weighted_kappa

optimizer:
  type: SGD
  args:
    lr: 0.1
    momentum: 0.9
    nesterov: True
    weight_decay: 0.0005

training:
  early_stop: 200
  epochs: 200
  monitor: min val_loss
  save_period: 2
  tensorboard: true
  verbose: 2

testing:
  data_dir: data/raw
  ensemble_size: 10
  batch_size: 64
  num_workers: 8
  verbose: 2
